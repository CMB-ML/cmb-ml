defaults:
  - cmb:   wmap_cosmo_means
  - noise: noise_spatial_corr
  # - noise: noise_variance
# PySM needs to run internal calculations at a resolution greater than the output nside (output nside set in experiment.yaml)

# PySM3 recommends either nside_sky=2048 for output_nside <= 1024; otherwise double it
#    While debugging code, it is often convenient to use lower resolution nside_sky
#    Only one of the two should be set. The other should be "null". Setting both may given unexpected results.
# Moved to top level for now
nside_sky            : ${nside_sky}
nside_sky_factor     : null
pysm_beam_lmax_ratio : 2.99999  # This will evaluate as 3 * nside - 1 for nsides up to 2048 (maybe further)

# Moved to top level for now
component_objects:
  - cmb
  - noise
seed_base_string: cmb_ml
# seed_base_string: ${dataset_name}
min_obs_beam         : ${min_obs_beam}
include_cmb    : True  # Defaults to true if not included. Will still produce power spectra, only affects making sky and observations.

fg_seed_template: "{split}_{sim}_{fg_str}_{fg_param}"

# See https://galsci.github.io/blog/2022/common-fiducial-sky/ and https://galsci.github.io/blog/2022/common-fiducial-extragalactic-cmb/ for more suggestions
# These parameters are pulled directly from the PySM3 configs, with the exception of the "dist" sub-dicts, which enable replacing scalars with random draws.
fgs:
  d9:
    class: "ModifiedBlackBody"
    map_I: "dust_gnilc/gnilc_dust_template_nside{nside}_2023.02.10.fits"
    # from Planck 2018 XI
    map_mbb_index: 1.48
    map_mbb_temperature: 19.6
    unit_mbb_temperature: "K"
    freq_ref_I: "353 GHz"
    freq_ref_P: "353 GHz"  # Must be included
    max_nside: 8192
    available_nside: [2048, 4096, 8192]
    # has_polarization: false  # Causes failure. PySM3 does not handle has_polarization == False.
    dist:
      mbb_index: {draw: Uniform, low: 1.332, high: 1.628} # default: 1.48 (+/- 10%)
      # mbb_index: {draw: Uniform, low: 1.44, high: 1.52} # default: 1.48
      mbb_temperature: {draw: Uniform, low: 17.64, high: 21.56, unit: "K"} # default: 19.6 (+/- 10%)
  s4:
    class: "PowerLaw"
    map_I: "synch/synch_template_nside{nside}_2023.02.25.fits"
    map_pl_index: -3.1
    freq_ref_I: "23 GHz"
    freq_ref_P: "23 GHz"
    max_nside: 8192
    available_nside: [2048, 4096, 8192]
    has_polarization: false
    dist:
      pl_index: {draw: Normal, loc: -3.1, scale: 0.31} # default: -3.1 (+/- 10%)
  f1:
    class: "PowerLaw"
    map_I: "pysm_2/ff_t_new.fits"
    unit_I: "uK_RJ"
    map_pl_index: -2.14
    freq_ref_I: "30 GHz"
    has_polarization: false
    dist:
      pl_index: {draw: Normal, loc: -2.14, scale: 0.21}  # default: -2.14 (+/- 10%)
  # All others have fixed maps
  a1:
    a1.comp1:
      class: "SpDust"
      map_I: "pysm_2/ame_t_new.fits"
      unit_I: "uK_RJ"
      freq_ref_I: "22.8 GHz"
      emissivity: "pysm_2/emissivity.txt"
      freq_peak: "pysm_2/ame_nu_peak_0.fits"
      freq_ref_peak: "30 GHz"
    a1.comp2:
      class: "SpDust"
      map_I: "pysm_2/ame2_t_new.fits"
      unit_I: "uK_RJ"
      freq_ref_I: "41 GHz"
      emissivity: "pysm_2/emissivity.txt"
      freq_peak: "33.35 GHz"
      freq_ref_peak: "30 GHz"
  cib1:
    class: "WebSkyCIB"
    websky_version: "0.4"
    input_units: "MJy / sr"
    interpolation_kind: "linear"
    apply_SPT_correction: true
    max_nside: 4096
  rg1:
    class: "WebSkyRadioGalaxies"
    websky_version: "0.4"
    input_units: "Jy / sr"
    interpolation_kind: "linear"
    apply_SPT_correction: false
    max_nside: 4096
  ksz1:
    class: "WebSkySZ"
    version: "0.4"
    sz_type: "kinetic"
    max_nside: 4096
  tsz1:
    class: "WebSkySZ"
    version: "0.4"
    sz_type: "thermal"
    max_nside: 4096
  # co1:
  #   class: "COLines"
  #   has_polarization: false
